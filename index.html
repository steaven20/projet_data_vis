<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>HeadMap.js</title>
    <!--Framework-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <div id="heatmap"></div>
    <canvas id="canvas"></canvas>
    <script type="text/javascript">
      var width = 400;
      var height = 400;
      var raduis = 10;
      var svg = d3
        .select("body")
        .select("div#heatmap")
        .append("svg")
        .attr("id", "svg_page")
        .attr("width", width)
        .attr("height", height)
        .attr("xmlns", "http://www.w3.org/2000/svg");

      //define dfs
      var defs = svg.append("defs");

      //Create a radial gradient
      const radialGradient = defs
        .append("radialGradient")
        .attr("id", "blue-gradient");

      radialGradient //linearGradient中插入stop元素
        .append("stop")
        .attr("offset", "0%") //设置坡度，下同
        .attr("stop-color", "rgba(0,0,0,1)"); //设置对应颜色，下同

      radialGradient
        .append("stop")
        .attr("offset", "100%")
        .attr("stop-color", "rgba(0,0,0,0)");

      // now generate some random data
      var points = [];
      var max = 0;
      var len = 100;
      var maxWeight = 100;

      while (len--) {
        var val = Math.floor(Math.random() * maxWeight);
        max = Math.max(max, val);
        var point = {
          //这里可以自定义
          x: Math.floor(Math.random() * width),
          y: Math.floor(Math.random() * height),
          value: val
        };
        points.push(point);
      }

      // part3 draw map weight with circle
      //transfor obj stype vg to type canvas
      grapheCircle = svg
        .selectAll("circle")
        .data(points)
        .join("circle")
        .attr("cx", function (d) {
          return d.x;
        })
        .attr("cy", function (d) {
          return d.y;
        })
        .attr("r", raduis)
        .style("opacity", function (d) {
          var value = (d.value / maxWeight) * 100;
          return value + "%";
        })
        .attr("fill", "url(#blue-gradient)");

      // part4 injection map with color
      // transfrom img svg to img canvas
    </script>
  </body>
</html>
